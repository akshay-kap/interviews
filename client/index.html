---
---
<!DOCTYPE HTML>
<html>
  {% include head.html %}
  <body>
    <button id="create">Create Room</button>
    <pre><code id="logs"></code></pre>
    <script>
      window.API = "{{ site.env['15SECONDLY_API'] }}";

      document.getElementById("create").addEventListener("click", function(event) {
        fetch(window.API + "/room", { method: "POST" })
          .then(response => response.json())
          .then(viewRoom)
      });

      function viewRoom(room) {
        const callFrame = window.DailyIframe.createFrame();
        callFrame.join({ url: room.url });
        callFrame.on("loaded", () => setInterval(() => callFrame.getNetworkStats().then(log), 2000));
      }

      function log(data) {
        window.logs.innerHTML += JSON.stringify(data) + "\n";
      }
    </script>     
  </body>
</html>
