---
layout: default
---

<h1>Dashboard</h1>
<a id="create" href="#">New Room</a>
<ul id="rooms"></ul>

<script>
  setupRooms();
  document.getElementById("create").addEventListener("click", newRoom);

  function setupRooms() {
    fetch(window.API + "/rooms", { method: "GET" })
      .then(response => response.json())
      .then(viewRooms);
  }

  function viewRooms(array) {
    const parent = document.getElementById("rooms");
    for (const [ url, stats ] of array) {
      const li = document.createElement("li");
      li.innerText = url;
      parent.appendChild(li);
    }
  }

  function newRoom() {
    fetch(window.API + "/room", { method: "POST" })
      .then(response => response.json())
      .then(room => window.location.href = "/call?url=" + encodeURIComponent(room.url));
  }
</script>
